R := inputfromfile(sales1)
S := inputfromfile(sales2)
Hash (R, time)
R1 := select(R, (time > 50) or (qty < 30)) 
R2 := project(R1, saleid, qty, pricerange)
Hash (S, Q)
Btree (R, qty)
T1 := join(R1, S, (R1.saleid = S.saleid)) 
T2prime := sort(T1, R1_time, S_C) 
T3 := movavg(T2prime, R1_qty, 3) 
T4 := movsum(T2prime, R1_qty, 5) 
Q2 := select(R, qty = 5) 
Q4 := select(R, itemid < 90) 
Q5 := concat(Q4, Q2) 
outputtofile(T3,T3)
outputtofile(T4,T4)