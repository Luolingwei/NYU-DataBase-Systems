R := inputfromfile(sales1)
S := inputfromfile(sales2)
Hash (R, time)
R1 := select(R,  (time>50) and (qty < 30) and (pricerange=moderate)) 
Hash (S, Q)
BTree (R, qty)
T1 := join(R1, S, R1.qty > S.Q) 
T2prime := sort(T1, R1_time, S_C) 
Q2 := select(R, qty = 5) 
Q4 := select(R, itemid < 90) 
Q5 := concat(Q4, Q2) 